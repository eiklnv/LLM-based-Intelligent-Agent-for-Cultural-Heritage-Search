# RelicSeek 搜索调试功能说明

## 概述

为了帮助开发者更好地理解和调试RelicSeek系统的搜索过程，我们在各个搜索组件中添加了详细的调试信息打印功能。

## 调试功能详情

### 1. SearxngTool 类调试信息

**位置**: `relicseek/engine/tools.py` - `SearxngTool` 类

**调试信息包括**:
- 🔍 搜索开始标识
- 📝 搜索关键词
- 🌐 搜索语言设置
- 📂 搜索分类配置
- 🔧 搜索引擎配置
- 📊 最大结果数设置
- 🌍 SearXNG服务地址
- 📋 完整搜索参数
- 🚀 请求URL
- ✅ 请求状态码
- 📥 原始结果数量
- 📄 每个搜索结果的详细信息（标题、URL、内容摘要、相关性评分、来源）
- 🎯 最终返回结果数量

**示例输出**:
```
============================================================
🔍 开始执行SearXNG搜索
📝 搜索关键词: 青铜器 文物
🌐 搜索语言: zh-CN
📂 搜索分类: ['general']
🔧 搜索引擎: ['bing', 'google']
📊 最大结果数: 20
🌍 服务地址: http://localhost:8888
📋 搜索参数: {'q': '青铜器 文物', 'format': 'json', 'language': 'zh-CN', 'safesearch': '1'}
🚀 发送请求到: http://localhost:8888/search
✅ 请求成功，状态码: 200
📥 收到原始结果数量: 15
📄 结果 1:
   📌 标题: 中国青铜器发展史 - 百度百科
   🔗 URL: https://baike.baidu.com/item/青铜器
   📝 内容摘要: 青铜器是中国古代重要的文物类型...
   ⭐ 相关性评分: 4.20
   🏢 来源: baike.baidu.com
🎯 最终返回结果数量: 15
============================================================
```

### 2. WebContentExtractor 类调试信息

**位置**: `relicseek/engine/tools.py` - `WebContentExtractor` 类

**调试信息包括**:
- 📄 内容提取开始标识
- 🔗 目标URL
- 📏 最大内容长度设置
- ✅ 网页请求状态码
- 📝 响应编码信息
- 📊 响应内容长度
- 📌 提取到的标题
- 🎯 内容提取策略（主要内容区域/body区域/整个页面）
- 🧹 内容清理前后长度对比
- ✂️ 内容截断信息
- 📋 最终内容长度

### 3. RelicSearchToolkit 类调试信息

**位置**: `relicseek/engine/tools.py` - `RelicSearchToolkit` 类

**调试信息包括**:
- 🔧 工具包初始化信息
- 📂 默认搜索分类
- 🔧 默认搜索引擎
- 🏛️ 文物搜索开始标识
- 📝 原始查询和增强后查询
- 📊 最大结果数设置
- ✅ 搜索完成状态
- 📋 搜索结果摘要（前5个结果）
- 📄 网页内容提取状态

### 4. RelicSeekAgent 类调试信息

**位置**: `relicseek/engine/agent.py` - `RelicSeekAgent` 类

**调试信息包括**:
- 🤖 智能体处理开始标识
- 📝 用户查询内容
- 🔍 搜索上下文信息
- 🔍 步骤1: 查询分析过程和结果
- 🎯 步骤2: 搜索策略制定过程和关键词
- 🔍 步骤3: 搜索执行和智能体输出
- 🔍 步骤4: 验证反思和质量评分
- 📝 步骤5: 最终报告生成
- 🎉 智能体处理完成标识

### 5. RelicSeekEngine 类调试信息

**位置**: `relicseek/engine/core.py` - `RelicSeekEngine` 类

**调试信息包括**:
- 🚀 引擎搜索开始标识
- 🆔 搜索ID
- 📝 用户查询
- 👤 用户ID
- 💬 会话ID
- ⏰ 开始时间
- 🔍 搜索上下文构建状态
- 🤖 智能体调用状态
- ✅ 搜索结果组件状态（查询分析、搜索策略、搜索结果、最终报告）
- 📊 执行迭代次数
- 🎉 搜索完成状态

## 使用方法

### 1. 启用调试信息

调试信息通过Python的logging模块输出，默认级别为INFO。确保日志配置正确：

```python
import logging

# 设置日志级别
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
```

### 2. 运行测试

使用提供的测试脚本验证调试功能：

```bash
python test_debug.py
```

### 3. 在实际应用中使用

调试信息会在每次搜索时自动输出，无需额外配置。在开发环境中，这些信息会帮助您：

- 了解搜索过程的每个步骤
- 诊断搜索失败的原因
- 优化搜索参数和策略
- 监控系统性能

## 调试信息级别

- **INFO**: 正常的搜索流程信息
- **ERROR**: 搜索过程中的错误信息
- **WARNING**: 搜索完成但可能存在问题

## 注意事项

1. 调试信息包含详细的搜索参数和结果，在生产环境中可能需要调整日志级别
2. 某些调试信息可能包含敏感内容，请注意日志文件的安全性
3. 调试信息会增加日志文件大小，建议定期清理
4. 如果SearXNG服务未运行，搜索会失败，但调试信息仍会正常显示

## 自定义调试信息

如需添加更多调试信息，可以在相应的类中添加logger调用：

```python
self.logger.info("🔍 自定义调试信息")
self.logger.error("❌ 错误信息")
self.logger.warning("⚠️ 警告信息")
```

## 故障排除

如果调试信息没有显示：

1. 检查日志级别设置
2. 确认logger配置正确
3. 检查是否有日志处理器配置
4. 验证代码中的logger调用是否正确
